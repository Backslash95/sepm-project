<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3c.org/1999/xhtml"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:p="http://primefaces.org/ui"
template="/WEB-INF/templates/main.xhtml">
	<ui:define name ="content">
		<!-- Checked in info -->
		<f:metadata>
    		<f:viewAction action="#{messageBean.infoStudentCheckedIn}" />
		</f:metadata>
		<h:form>
 		   <p:messages id="messages" showDetail="true" autoUpdate="true" closable="true" rendered="#{checkInCheckOutBean.checkedIn}"/>
 		</h:form>
		<h:form id="workPackageForm">
				<!-- Create new work packages -->
				<p:panel id="newPackage" header="Create new work package">
					<h:panelGrid columns="3" cellpadding="5">
						<p:outputLabel for="newWorkPackage" value="Package name: " />
						<p:inputText id="newWorkPackage" value="#{inputTextCacheBean.workPackageName}"/>
						<p:commandButton value="Create"
										 action="work_packages.xhtml?faces-redirect=true"
										 actionListener="#{workPackageService.createWorkPackage(sessionInfoBean.currentUser.project, sessionInfoBean.currentUser, inputTextCacheBean.workPackageName)}"
										 icon="ui-icon-check"/>
					</h:panelGrid>
				</p:panel>
<!-- DEBUG 	<h1>THIS DATATABLE IS SHOWN IN DEBUG MODE!</h1>
				<p:dataTable id="usersTable" 
							 var="workPackage" 
							 value="#{workPackageListController.getWorkPackages(sessionInfoBean.currentUser.project)}">
				<p:column headerText="Work Package Name">
<h:outputText value="#{workPackage.packageName}"/>
</p:column>
<p:column headerText="Project Name">
<h:outputText value="#{workPackage.project.projectName}"/>
</p:column>
				<p:column headerText="Work Package">
<h:outputText value="#{workPackage.status}"/>
</p:column>			
				</p:dataTable> 
-->
				<!-- Check-in Check-out listbox -->
<!-- TODO Command buttons should depend on students checked-in / checked-out status.
		  Maybe additional button necessary (not clear yet, when selection in listbox is
		  fired) -->
				<p:panel id="checkInCheckout" header="Check-in / Check-out on work package">
					<h:panelGrid columns="5" style="margin-bottom:10px;width:60%">
						<p:outputLabel for="list" value="Select:" />
						<p:selectOneListbox id="list" 
											value="#{checkInCheckOutBean.workPackage}" 
											valueChangeListener="#{checkInCheckOutBean.valueChanged}"
											disabled="#{checkInCheckOutBean.checkedIn}">											>
							<f:selectItems value="#{checkInCheckOutBean.workPackages}" 
										   var="workPackage" 
										   itemLabel="#{workPackage.packageName}"
										   itemValue="#{workPackage.packageName}"/>
						</p:selectOneListbox>
						<p:commandButton value="Check-in"
										 action="work_packages.xhtml?faces-redirect=true"
										 actionListener="#{worksOnService.startSession(sessionInfoBean.currentUser, checkInCheckOutBean.selectedWorkPackage)}"
										 disabled="#{checkInCheckOutBean.checkedIn}"/>
						<p:commandButton value="Check-out"
										 action="work_packages.xhtml?faces-redirect=true" 
										 actionListener="#{worksOnService.endSession(sessionInfoBean.currentUser.session)}"
										 disabled="#{not checkInCheckOutBean.checkedIn}"/>
					</h:panelGrid>
				</p:panel>
		</h:form>
	</ui:define>
</ui:composition>