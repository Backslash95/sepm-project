<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3c.org/1999/xhtml"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:ng="http://xmlns.jcp.org/jsf/passthrough"
				xmlns:p="http://primefaces.org/ui"
				template="/WEB-INF/templates/main.xhtml">
	<ui:define name ="content">
		<h:form>
			<p:panel header="Welcome!">
				<h:outputText value="Welcome, #{sessionInfoBean.getCurrentUserName()}"/>			
			</p:panel>
			<p:panel header="Overview">
				<!-- Student overview messages -->
					<h:panelGrid columns="2" rendered="#{sessionInfoBean.hasRole('STUDENT')}" style="width:35%">
						<h:outputText value="You participate in project:" />
						<h:outputText value="#{welcomeInfoBean.studentInProjectMessage()}" style="font-weight:bold" />
						
						<h:outputText value="Which is supervised by:" rendered="#{welcomeInfoBean.studentIsInProject()}" />
						<h:outputText value="#{welcomeInfoBean.studentProjectSupervisorMessage()}" 
									  rendered="#{welcomeInfoBean.studentIsInProject()}"
									  style="font-weight:bold" />
					
						<h:outputText value="You're currently checked-in on work package:" />
						<h:outputText value="#{welcomeInfoBean.studentCheckedInMessage()}" style="font-weight:bold" />

						<h:outputText value="Quick check-in / check-out" />
						<p:commandButton value="Check-out"
										 action="welcome.xhtml?faces-redirect=true" 
										 actionListener="#{worksOnService.endSession(sessionInfoBean.currentUser.session)}"
										 disabled="#{not checkInCheckOutBean.checkedIn}"/>
				</h:panelGrid>
				<!-- PS Leader overview messages -->
				<h:panelGrid columns="2" rendered="#{sessionInfoBean.hasRole('PSLEADER')}">
					<h:outputText value="You are the supervisor of Project:" />
					<h:outputText value="#{welcomeInfoBean.psLeaderSupervisorMessage()}" style="font-weight:bold" />
				</h:panelGrid>				
				<br/>
				<!-- Data Grid panel for Students -->
				<p:dataGrid var="student" 
							value="#{userListController.getUsersByProject(sessionInfoBean.currentUser.project)}"
							columns="2"
							layout="grid"
							rows="12"
							paginator="true"
							id="students"
							paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
        					rowsPerPageTemplate="6,12,16"
        					rendered="#{sessionInfoBean.hasRole('STUDENT')  and welcomeInfoBean.studentIsInProject()}">
        			
        			<f:facet name="header">
        				<h:outputText value="Other students in #{sessionInfoBean.currentUser.project.projectName}"/>
        			</f:facet>
        			
        			<p:panel header="#{student.username}" style="text-align:left">
        			<h:panelGrid columns="2" style="width:80%" columnClasses="logo,detail">
        				<h:graphicImage url="/resources/images/user-silhouette.png" style="width:100px"/>
        				<p:outputPanel>
        				<h:panelGrid columns="2" >
        					
        					<h:outputText value="Firstname:" />
        					<h:outputText value="#{student.firstName}" style="font-weight:bold"/>
        					
        					<h:outputText value="Lastname:" />        			
        			        <h:outputText value="#{student.lastName}" style="font-weight:bold"/>
        			        
        			        <h:outputText value="email:" />		
        			        <h:outputText value="#{student.email}" style="font-weight:bold"/>
        			    </h:panelGrid>
        			</p:outputPanel>
        			</h:panelGrid>    
        			</p:panel>					
        		</p:dataGrid>
			</p:panel>
		</h:form>
	</ui:define>
</ui:composition>